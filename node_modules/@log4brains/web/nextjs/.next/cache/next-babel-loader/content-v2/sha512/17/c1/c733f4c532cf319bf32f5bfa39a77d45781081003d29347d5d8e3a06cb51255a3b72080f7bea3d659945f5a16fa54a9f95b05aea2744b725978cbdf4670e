{"ast":null,"code":"import _Hidden from \"@material-ui/core/Hidden\";\nimport _Drawer from \"@material-ui/core/Drawer\";\nimport _AppBar from \"@material-ui/core/AppBar\";\nimport _NoSsr from \"@material-ui/core/NoSsr\";\nimport _Backdrop from \"@material-ui/core/Backdrop\";\nimport _Link from \"@material-ui/core/Link\";\nimport _Menu from \"@material-ui/icons/Menu\";\nimport _List from \"@material-ui/core/List\";\nimport _Grow from \"@material-ui/core/Grow\";\nimport _Fade from \"@material-ui/core/Fade\";\nimport _CircularProgress from \"@material-ui/core/CircularProgress\";\nimport _Typography from \"@material-ui/core/Typography\";\nimport _Toolbar from \"@material-ui/core/Toolbar\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _Close from \"@material-ui/icons/Close\";\nimport _IconButton from \"@material-ui/core/IconButton\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React from \"react\";\nimport { createStyles, makeStyles } from \"@material-ui/core/styles\"; // import {\n//   ChevronRight as ChevronRightIcon,\n//   PlaylistAddCheck as PlaylistAddCheckIcon\n// } from \"@material-ui/icons\";\n\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport clsx from \"clsx\";\nimport { AdrMenu } from \"./components/AdrMenu\";\nimport { ConnectedSearchBox } from \"./components/ConnectedSearchBox/ConnectedSearchBox\";\nimport { AdrNavContext } from \"../../contexts\";\nimport { RoutingProgress } from \"./components/RoutingProgress\";\nconst drawerWidth = 380;\nconst searchTransitionDuration = 300;\nconst useStyles = makeStyles(theme => {\n  const topSpace = theme.spacing(6);\n  return createStyles({\n    root: {\n      display: \"flex\"\n    },\n    layoutLeftCol: {\n      flexGrow: 0.5,\n      [theme.breakpoints.down(\"md\")]: {\n        display: \"none\"\n      }\n    },\n    layoutCenterCol: {\n      paddingLeft: theme.custom.layout.centerColPadding,\n      paddingRight: theme.custom.layout.centerColPadding,\n      flexGrow: 1,\n      [theme.breakpoints.up(\"md\")]: {\n        flexGrow: 0,\n        flexShrink: 0,\n        flexBasis: theme.custom.layout.centerColBasis\n      }\n    },\n    layoutRightCol: {\n      flexGrow: 1,\n      flexBasis: theme.custom.layout.rightColBasis,\n      [theme.breakpoints.down(\"md\")]: {\n        display: \"none\"\n      }\n    },\n    appBar: {\n      zIndex: theme.zIndex.drawer + 1\n    },\n    appBarMenuButton: {\n      [theme.breakpoints.up(\"sm\")]: {\n        display: \"none\"\n      }\n    },\n    appBarTitle: {\n      display: \"none\",\n      [theme.breakpoints.up(\"sm\")]: {\n        display: \"flex\",\n        alignItems: \"center\",\n        width: drawerWidth - theme.spacing(3),\n        flexGrow: 0,\n        flexShrink: 0,\n        cursor: \"pointer\"\n      }\n    },\n    appBarTitleLink: {\n      display: \"block\",\n      color: \"inherit\",\n      \"&:hover\": {\n        color: \"inherit\"\n      },\n      marginLeft: theme.spacing(2)\n    },\n    searchBackdrop: {\n      zIndex: theme.zIndex.modal - 2\n    },\n    searchBox: {\n      zIndex: theme.zIndex.modal - 1,\n      width: \"100%\",\n      [theme.breakpoints.up(\"md\")]: {\n        width: \"70%\"\n      },\n      transition: theme.transitions.create(\"width\", {\n        duration: searchTransitionDuration\n      })\n    },\n    searchBoxOpen: {\n      width: \"100%\"\n    },\n    drawer: {\n      [theme.breakpoints.up(\"sm\")]: {\n        width: drawerWidth,\n        flexShrink: 0\n      }\n    },\n    drawerPaper: {\n      width: drawerWidth\n    },\n    drawerContainer: {\n      height: \"100%\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      [theme.breakpoints.up(\"sm\")]: {\n        paddingTop: topSpace\n      }\n    },\n    drawerToolbar: {\n      visibility: \"visible\",\n      [theme.breakpoints.up(\"sm\")]: {\n        visibility: \"hidden\"\n      },\n      justifyContent: \"space-between\"\n    },\n    adrMenu: {\n      flexGrow: 1,\n      flexShrink: 1,\n      overflow: \"auto\",\n      \"&::-webkit-scrollbar\": {\n        width: 6,\n        backgroundColor: theme.palette.background\n      },\n      \"&::-webkit-scrollbar-thumb\": {\n        borderRadius: 10,\n        \"-webkit-box-shadow\": \"inset 0 0 2px rgba(0,0,0,.3)\",\n        backgroundColor: theme.palette.grey[400]\n      }\n    },\n    bottomMenuList: {\n      flexGrow: 0,\n      flexShrink: 0\n    },\n    adlTitleAndSpinner: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      paddingLeft: theme.spacing(2),\n      [theme.breakpoints.up(\"sm\")]: {\n        paddingLeft: theme.spacing(3)\n      },\n      paddingBottom: theme.spacing(0.5),\n      paddingRight: theme.spacing(3)\n    },\n    adlTitle: {\n      fontWeight: theme.typography.fontWeightBold\n    },\n    adrMenuSpinner: {\n      alignSelf: \"center\",\n      marginTop: \"30vh\"\n    },\n    container: {\n      flexGrow: 1,\n      paddingTop: theme.spacing(2),\n      [theme.breakpoints.up(\"sm\")]: {\n        paddingTop: topSpace\n      }\n    },\n    content: {\n      minHeight: `calc(100vh - 35px - ${theme.spacing(1) + theme.spacing(8)}px)`,\n      // TODO: calc AppBar height more precisely\n      [theme.breakpoints.up(\"sm\")]: {\n        minHeight: `calc(100vh - 35px - ${topSpace + theme.spacing(8)}px)` // TODO: calc AppBar height more precisely\n\n      }\n    },\n    footer: {\n      backgroundColor: theme.palette.grey[100],\n      color: theme.palette.grey[500],\n      height: 35,\n      display: \"flex\",\n      marginTop: theme.spacing(6)\n    },\n    footerText: {\n      fontSize: \"0.77rem\"\n    },\n    footerLink: {\n      color: theme.palette.grey[600],\n      fontSize: \"0.8rem\",\n      \"&:hover\": {\n        color: theme.palette.grey[800]\n      }\n    },\n    footerContent: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"center\"\n    }\n  });\n});\n\nfunction buildAdrNav(currentAdr, adrs) {\n  const currentIndex = adrs.map((adr, index) => adr.slug === currentAdr.slug ? index : undefined).filter(adr => adr !== undefined).pop();\n  const previousAdr = currentIndex !== undefined && currentIndex < adrs.length - 1 ? adrs[currentIndex + 1] : undefined;\n  const nextAdr = currentIndex !== undefined && currentIndex > 0 ? adrs[currentIndex - 1] : undefined;\n  return {\n    previousAdr,\n    nextAdr\n  };\n}\n\nexport function AdrBrowserLayout({\n  projectName,\n  adrs,\n  adrsReloading = false,\n  currentAdr,\n  children,\n  routing = false,\n  l4bVersion\n}) {\n  const classes = useStyles();\n  const router = useRouter();\n  const [mobileDrawerOpen, setMobileDrawerOpen] = React.useState(false);\n\n  const handleMobileDrawerToggle = () => {\n    setMobileDrawerOpen(!mobileDrawerOpen);\n  };\n\n  React.useEffect(() => {\n    const closeMobileDrawer = () => setMobileDrawerOpen(false);\n\n    router === null || router === void 0 ? void 0 : router.events.on(\"routeChangeStart\", closeMobileDrawer);\n    return () => {\n      router === null || router === void 0 ? void 0 : router.events.off(\"routeChangeStart\", closeMobileDrawer);\n    };\n  }, [router]);\n  const [searchOpen, setSearchOpenState] = React.useState(false);\n  const [searchReallyOpen, setSearchReallyOpenState] = React.useState(false);\n\n  const drawer = /*#__PURE__*/_jsxs(\"div\", {\n    className: classes.drawerContainer,\n    children: [/*#__PURE__*/_jsxs(_Toolbar, {\n      className: classes.drawerToolbar,\n      children: [/*#__PURE__*/_jsx(\"div\", {}), /*#__PURE__*/_jsx(Link, {\n        href: \"/\",\n        passHref: true,\n        children: /*#__PURE__*/_jsx(_IconButton, {\n          size: \"small\",\n          color: \"inherit\",\n          \"aria-label\": \"go to homepage\",\n          title: `Architecture knowledge base of ${projectName}`,\n          children: /*#__PURE__*/_jsx(\"img\", {\n            src: `${router === null || router === void 0 ? void 0 : router.basePath}/l4b-static/Log4brains-logo.png`,\n            alt: \"Log4brains logo\",\n            width: 40,\n            height: 40\n          })\n        })\n      }), /*#__PURE__*/_jsx(_IconButton, {\n        size: \"small\",\n        color: \"inherit\",\n        \"aria-label\": \"close drawer\",\n        title: \"Close\",\n        onClick: handleMobileDrawerToggle,\n        children: /*#__PURE__*/_jsx(_Close, {\n          fontSize: \"small\"\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: classes.adlTitleAndSpinner,\n      children: [/*#__PURE__*/_jsx(_Typography, {\n        variant: \"subtitle2\",\n        className: classes.adlTitle,\n        children: \"Decision log\"\n      }), /*#__PURE__*/_jsx(_Fade, {\n        in: adrsReloading,\n        children: /*#__PURE__*/_jsx(_CircularProgress, {\n          size: 13\n        })\n      })]\n    }), /*#__PURE__*/_jsx(_Grow, {\n      in: adrs !== undefined,\n      style: {\n        transformOrigin: \"center left\"\n      },\n      children: /*#__PURE__*/_jsx(AdrMenu, {\n        adrs: adrs,\n        currentAdrSlug: currentAdr === null || currentAdr === void 0 ? void 0 : currentAdr.slug,\n        className: classes.adrMenu\n      })\n    }), adrs === undefined && /*#__PURE__*/_jsx(_CircularProgress, {\n      size: 30,\n      className: classes.adrMenuSpinner\n    }), /*#__PURE__*/_jsx(_List, {\n      className: classes.bottomMenuList\n    })]\n  });\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: classes.root,\n    children: [/*#__PURE__*/_jsxs(_AppBar, {\n      position: \"fixed\",\n      className: classes.appBar,\n      children: [routing && /*#__PURE__*/_jsx(RoutingProgress, {}), /*#__PURE__*/_jsxs(_Toolbar, {\n        children: [/*#__PURE__*/_jsx(_IconButton, {\n          color: \"inherit\",\n          \"aria-label\": \"open drawer\",\n          edge: \"start\",\n          onClick: handleMobileDrawerToggle,\n          className: classes.appBarMenuButton,\n          children: /*#__PURE__*/_jsx(_Menu, {})\n        }), /*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: classes.appBarTitle,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: `${router === null || router === void 0 ? void 0 : router.basePath}/l4b-static/Log4brains-logo-dark.png`,\n                alt: \"Log4brains logo\",\n                width: 50,\n                height: 50\n              })\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              children: [/*#__PURE__*/_jsx(Link, {\n                href: \"/\",\n                passHref: true,\n                children: /*#__PURE__*/_jsx(_Link, {\n                  variant: \"h6\",\n                  noWrap: true,\n                  className: classes.appBarTitleLink,\n                  children: projectName\n                })\n              }), /*#__PURE__*/_jsx(Link, {\n                href: \"/\",\n                passHref: true,\n                children: /*#__PURE__*/_jsx(_Link, {\n                  variant: \"body2\",\n                  noWrap: true,\n                  className: classes.appBarTitleLink,\n                  children: \"Architecture knowledge base\"\n                })\n              })]\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: classes.layoutLeftCol\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: clsx(classes.layoutCenterCol),\n          children: [/*#__PURE__*/_jsx(_Backdrop, {\n            open: searchOpen,\n            className: classes.searchBackdrop\n          }), /*#__PURE__*/_jsx(_NoSsr, {\n            children: /*#__PURE__*/_jsx(ConnectedSearchBox, {\n              onOpen: () => {\n                setSearchOpenState(true); // Delayed real opening because otherwise the dropdown width is bugged\n\n                setTimeout(() => setSearchReallyOpenState(true), searchTransitionDuration + 100);\n              },\n              onClose: () => {\n                setSearchOpenState(false);\n                setSearchReallyOpenState(false);\n              },\n              open: searchReallyOpen,\n              className: clsx(classes.searchBox, {\n                [classes.searchBoxOpen]: searchOpen\n              })\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: classes.layoutRightCol\n        })]\n      })]\n    }), /*#__PURE__*/_jsxs(\"nav\", {\n      className: classes.drawer,\n      \"aria-label\": \"architecture decision records list\",\n      children: [/*#__PURE__*/_jsx(_Hidden, {\n        smUp: true,\n        implementation: \"css\",\n        children: /*#__PURE__*/_jsx(_Drawer, {\n          variant: \"temporary\",\n          anchor: \"left\",\n          open: mobileDrawerOpen,\n          onClose: handleMobileDrawerToggle,\n          classes: {\n            paper: classes.drawerPaper\n          },\n          ModalProps: {\n            keepMounted: true // Better open performance on mobile.\n\n          },\n          children: drawer\n        })\n      }), /*#__PURE__*/_jsx(_Hidden, {\n        xsDown: true,\n        implementation: \"css\",\n        children: /*#__PURE__*/_jsx(_Drawer, {\n          variant: \"permanent\",\n          open: true,\n          classes: {\n            paper: classes.drawerPaper\n          },\n          children: drawer\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: classes.container,\n      children: [/*#__PURE__*/_jsx(_Toolbar, {}), /*#__PURE__*/_jsx(\"main\", {\n        className: classes.content,\n        children: /*#__PURE__*/_jsx(AdrNavContext.Provider, {\n          value: currentAdr && adrs ? buildAdrNav(currentAdr, adrs) : {},\n          children: children\n        })\n      }), /*#__PURE__*/_jsxs(\"footer\", {\n        className: classes.footer,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: classes.layoutLeftCol\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: clsx(classes.layoutCenterCol, classes.footerContent),\n          children: /*#__PURE__*/_jsxs(_Typography, {\n            className: classes.footerText,\n            children: [\"Powered by\", \" \", /*#__PURE__*/_jsx(_Link, {\n              href: \"https://github.com/thomvaill/log4brains\",\n              className: classes.footerLink,\n              target: \"_blank\",\n              rel: \"noopener\",\n              children: \"Log4brains\"\n            }), \" \", /*#__PURE__*/_jsx(\"span\", {\n              style: {\n                fontSize: \"0.8em\"\n              },\n              children: l4bVersion ? `(v${l4bVersion})` : null\n            })]\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: classes.layoutRightCol\n        })]\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}